## where in到底能不能命中索引？
看慢查询日志，经常看到很多sql语句执行慢，是因为where in导致，在计划执行的时候发现没有命中索引。  

原因是where in 的数组是字符串，而数据库字段是整型，将字段全部转化为整型之后，可以命中索引。  

所以想当然认为一定是是字段类型不一致导致的。后来发现其它的where in慢查询，虽然log显示慢，但实际执行的时候很快，即使字段类型不一致，也可以命中索引。眉头一皱，发现事情并不简单。  

下面是几个测试结果：
| where in 参数类型 | sql字段类型 | 索引类型 | 是否命中索引|
| - | - | - | - |
| 类型一致：字符串 | 字符串 | 单字段索引 | 命中 |
| 类型一致：整型 | 字符串 | 单字段索引 | 未命中 |
| 类型不一致：整型、字符串 | 字符串 | 单字段索引 | 未命中 |
| 类型一致：字符串 | 字符串 | 复合索引 | 命中 |
| 类型一致：整型 | 字符串 | 复合索引 | 命中 |
| 类型不一致：整型、字符串 | 字符串 | 复合索引 | 未命中 |

**总结：**  
1. 当where in参数类型`不一致`的时候，肯定是`无法命中索引`的
2. 当where in参数类型一致的时候，如果是`复合索引`，就`可以命中索引`；如果是单字段索引，必须参数类型跟字段类型一致，才能命中索引

